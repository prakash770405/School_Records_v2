<!DOCTYPE html>
<html lang="en">
<%- include('../includes/header') %>

<body class="bg-light">
  <%- include('../includes/navbar') %>
  <%- include("../includes/flash") %>

  <div class="container-fluid px-3 px-md-5 py-5">

    <!-- Title -->
    <div class="text-center mb-4">
      <h2 class="fw-semibold text-success mb-1">
        <i class="fa-solid fa-envelope-circle-check me-1"></i> Email Verification
      </h2>
      <p class="text-muted small fst-italic mb-0">
        Enter the 4-digit code sent to your email
      </p>
    </div>

    <!-- Card -->
    <div class="mx-auto" style="max-width: 720px;">

      <!-- OTP Form -->
      <form action="/admin/verify-otp" method="post">

        <input type="hidden" name="email" value="<%= email %>">

        <div class="mb-4">
          <label class="form-label fw-medium">
            <i class="fa-solid fa-shield-halved me-1 text-success"></i>
            Verification Code
          </label>

          <input
            type="text"
            class="form-control shadow-none text-center fs-5 fw-semibold"
            name="otp"
            maxlength="4"
            pattern="[0-9]{4}"
            required
          >

          <div class="form-text text-muted">
            Code expires in 5 minutes
          </div>
        </div>

        <!-- Buttons Row -->
       <!-- Buttons Row -->
<div class="d-flex justify-content-between align-items-center gap-2 mt-3 flex-nowrap">

  <!-- Verify -->
  <form action="/admin/verify-otp" method="post" class="m-0 flex-shrink-0">
    <input type="hidden" name="email" value="<%= email %>">
    <button type="submit" class="btn btn-success px-4">
      Verify
    </button>
  </form>

  <!-- Resend -->
  <form action="/admin/resend-otp" method="POST" class="m-0 flex-shrink-0">
    <input type="hidden" name="email" value="<%= email %>">
    <button
      type="submit"
      id="resendBtn"
      class="btn btn-outline-secondary px-3"
      disabled
    >
      Resend OTP (<span id="timer">30</span>s)
    </button>
  </form>

</div>


    </div>
  </div>

  <%- include('../includes/footer') %>

  <!-- Timer -->
  <script>
    let timeLeft = 60;
    const timerEl = document.getElementById("timer");
    const resendBtn = document.getElementById("resendBtn");

    const countdown = setInterval(() => {
      timeLeft--;
      timerEl.textContent = timeLeft;

      if (timeLeft <= 0) {
        clearInterval(countdown);
        resendBtn.disabled = false;
        resendBtn.textContent = "Resend OTP";
      }
    }, 1000);
  </script>

</body>
</html>
